/*
 EasyRecipe PLUS 3.2.2708 Copyright (c) 2014 BoxHill LLC
*/
window.EASYRECIPE=window.EASYRECIPE||{};
(function(a){function v(b){var e,g;G.hide();if("OK"===b.status)a("#ERDOK").show();else{w.show();g=a("#ERDErrors",x);g.empty();for(e=0;e<b.errors.length;e++)g.append(a("<p>"+b.errors[e]+"</p>"));x.show()}}function k(a){y.tabs({active:a})}function H(b,e){a(e.newTab||e.tab).find("a").hasClass("ERSNoSave")?I.hide():I.show()}function c(){return""===a.trim(z.val())?(z.showErrorRight("Please enter your first name"),!1):!0}function h(){return P.test(a.trim(A.val()))?!0:(A.showErrorRight("Oops! This doesn't seem to be a valid email address"),
!1)}function l(){return""===a.trim(B.val())?(B.showErrorRight("Please tell us about the problem"),!1):!0}function d(){var b;a(".showError").dialog("destroy").remove();b=c();b=h()&&b;if(b=l()&&b)b={action:"easyrecipeSupport",inpName:encodeURIComponent(a.trim(z.val())),inpEmail:encodeURIComponent(a.trim(A.val())),inpSubject:encodeURIComponent(a.trim(a("#inpERDSubject").val())),inpMessage:encodeURIComponent(a.trim(B.val())),sendDiagnostics:a("#cbERDSendDiagnostics").attr("checked")},w.hide(),x.hide(),
G.show(),a.post(ajaxurl,b,v,"json")}function p(){a("#divERSStyles ").find(".ERSStyle").removeClass("ERSStyleSelected");a(this).addClass("ERSStyleSelected");Q.val(a("input",this).val())}function m(){a("#divERSPrintStyles").find(".ERSStyle").removeClass("ERSStyleSelected");a(this).addClass("ERSStyleSelected");R.val(a("input",this).val())}function C(){this.checked?D.removeClass("ERSNoSwoop"):D.addClass("ERSNoSwoop")}function q(){this.checked?J.removeClass("ERSNoSubscribe"):J.addClass("ERSNoSubscribe")}
function S(b,e){var g=a.trim(E.val());return""===g||P.test(g)?e&&""===g?(k(r),E.showErrorRight("You need to tell us your email address",{clear:"#cbERSSubscribe"}),!1):!0:(k(r),E.showErrorRight("Oops! This doesn't seem to be a valid email address",{clear:"#cbERSSubscribe"}),!1)}function T(b,e){var g,c=a.trim(t.val());if(""!==c){if(!/^SW-\d{8}-/i.test(c))return k(r),t.showErrorLeft("That's not a valid Swoop ID"),!1;a("a",s);g=a("a",s).attr("href");g=g.replace(/site_id=(.*)/ig,"site_id="+c);a("a",s).attr("href",
g);K.addClass(n);s.removeClass(n)}else K.removeClass(n),s.addClass(n);return e&&""===c?(k(r),t.showErrorLeft("You must enter a valid ID to enable Swoop"),!1):!0}function U(){var b,e,c=a.trim(u.val());u.val(c);if(""==c)return!0;b=$.test(c);if(!b&&!aa.test(c))return k(r),u.showErrorRight("This is not a valid license key"),!1;if(b){e="";for(b=0;8>b;b++)e+=c.substr(4*b,4)+"-";u.val(e.substr(0,39))}return!0}function ba(b){var c=!0;a(".showError").dialog("destroy").remove();c=U()&&c;V.is(":checked")&&(c=
S(null,!0));W.is(":checked")&&(c=T(null,!0)&&c);c||b.preventDefault()}function X(){L.html("Version check failed")}function ca(b){if(b.version&&b.msg)switch(L.html(b.msg),b.type){case "js":a("head").append(a('<script type="text/javascript">'+b.js+"\x3c/script>"));f[b.f]();break;case "html":a(b.dest).html(b.html)}else X()}function da(b){a("div",F).addClass(n);a("#divERS"+b.target.value+"Settings",F).removeClass(n);"Ziplist"==b.target.value&&(""===a("#divERSZiplistSettings").find("input").val()?a("#divERSZiplistLink").removeClass(n):
a("#divERSZiplistLink").addClass(n))}function ea(){a("#divFDFirstRun").hide();a("#divFDScanScheduled").show();a("#divFDRetrieving").hide();a("#divFDStatus").hide();(new Date).getTime();a("#inpFDEnable").attr("checked","checked")}function fa(){alert("Schedule failed")}function Y(b){b&&(b.stopPropagation(),b.preventDefault());a.ajax({url:ajaxurl,type:"post",data:{action:"easyrecipeScanSchedule"},success:ea,error:fa})}function ga(){confirm("You normally only need to run a site scan once but it won't do any harm to run it again\n\nPress OK to re-run a site scan")&&
Y()}function ha(b){var c,d=b.fields;for(c in d)d.hasOwnProperty(c)&&(b="#tdFD"+c,a(b).text(d[c]));a("#spnFDLASTSCAN").text(f.lastScan);a("#divFDRetrieving").hide();a("#divFDStatus").show()}function ia(){alert("Site statistics failed")}function Z(){a.ajax({url:ja,type:"POST",dataType:"json",data:{site:f.wpurl,apikey:f.fdAPIKey},success:ha,error:ia})}function ka(b){b.stopPropagation();b.preventDefault();a("#divFDScanScheduled").hide();a("#divFDRetrieving").show();Z()}function la(){a("#inpFDEnable").removeAttr("checked");
M.submit()}var Q,R,x,w,G,I,D,J,E,P=/^(?:[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)$/i,t,s,K,u,y,F,aa=/^(?:[a-f\d]{4}-){7}[a-f\d]{4}$/i,$=/^[a-f\d]{32}$/i,B,z,A,V,W,n="ERSDisplayNone",L,f,N,O,M,ja="http://www.fooderific.com/plugin/sitestats.php",r=0;a(function(){f=EASYRECIPE;f.isWP39&&(f.dialogs=a("<div>").addClass("easyrecipeUI").prop("id","easyrecipeUI").appendTo("body"));N=a("#divERSStyles");O=a("#divERSPrintStyles");
Q=N.find(".ERSSelectedStyle");R=O.find(".ERSSelectedPrintStyle");a("#easyrecipeUpgrade");w=a("#btnERSendSupport");y=a("#divERSTabs");y.tabs({active:r,beforeActivate:H});a(".ERSStyleTabs").tabs({active:0});L=a("#spnERSLatestVersion");N.on("click",".ERSStyle",p);O.on("click",".ERSStyle",m);I=a("#divERSSave").find("input").button();w.button().on("click",d);D=a("#divERSSwoopSettings");J=a("#trERSSubscribe");W=a("#cbERSEnableSwoop").on("click",C);V=a("#cbERSSubscribe").on("click",q);x=a("#ERDFail");G=
a("#ERDSending");F=a(".ERSSaveButtons");a('input[type="radio"]',F).on("change",da);E=a('.ERSSubscribe input[name="ERPlusSettings[erEmailAddress]"]').on("change",S);a(".ERSSubscribe").on("click",function(){a(".ERSubscribeError").css("visibility","hidden")});t=a('input[name="'+f.settingsName+'[swoopSiteID]"]',D);t.on("change",T);u=a('input[name="'+f.settingsName+'[licenseKey]"]').on("change",U);K=a("#divERSRegisterSwoop");s=a("#divERSLoginSwoop");M=a("#frmERSForm");M.on("submit",ba);z=a("#inpERDName").on("change",
c);A=a("#inpERDEmail").on("change",h);B=a("#inpERDProblem").on("change",l);f.jQuery=a;a("#btnFDStartScan").button().on("click",Y);a("#spnFDRescan").on("click",ga);a("#btnFDContinue").button().on("click",ka);a("#divFDDisable").on("click",la);a("#divFDRetrieving").hasClass("FDDisplayNone")||Z();a.ajax({url:"http://www.easyrecipeplugin.com/checkVersion.php",type:"GET",dataType:a.support.cors?"json":"jsonp",data:{a:"check",v:f.pluginVersion,k:f.license,u:f.wpurl,p:1},success:ca,error:X});y.show()})})(jQuery);
(function(a){function v(a){a.data.clear.off(k,v);a.data.errDiv.dialog("destroy");a.data.errDiv.remove()}var k="focus";a.fn.showError=function(H,c){var h,l,d,p,m,C,q;c=c||{};c.clear=c.clear||[];"string"===typeof c.clear&&(c.clear=[c.clear]);m=a("#divShowError");0===m.length&&(m=a('<div id="divShowError"></div>').appendTo("body"));p=this;h={position:"right",container:null,clear:[]};a.extend(h,c);for(d=0;d<h.clear.length;d++)p=p.add(h.clear[d]);d='<span class="showError showError-'+h.position+'">';d=
d+('<div class="showErrorLeftPtr"></div><div class="showErrorMsg">'+H)+'</div><div class="showErrorRightPtr"></div></span>';d=a(d);d.dialog({dialogClass:"showErrorDialog",draggable:!1,resizable:!1,autoOpen:!1,appendTo:m,closeText:"",width:"auto",position:"left"===h.position?{my:"right",at:"left",of:this}:{my:"left",at:"right",of:this}});d.dialog("open");"1.10.3"==a.ui.version&&(m=d.dialog("widget"),l=this.offset(),C=l.top+this.outerHeight()/2-12,q=l.left,l=d.outerWidth(),q="right"===h.position?q+
this.outerWidth():q-l,m.css({position:"absolute",top:C+"px",left:q+"px"}));p.on(k,{clear:p,errDiv:d},v)};a.fn.showErrorLeft=function(a,c){c=c||{};c.position="left";this.showError(a,c)};a.fn.showErrorRight=function(a,c){c=c||{};c.position="right";this.showError(a,c)}})(jQuery);
