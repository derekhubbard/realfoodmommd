/*
 EasyRecipe PLUS 3.2.2708 Copyright (c) 2014 BoxHill LLC
*/
(function(c){function r(h,a){var d,b,e=0;for(d=0;d<a.length;d++)b=f[a[d].id],"OK"===b.status&&(e+=b.nRecipes);c("#spnERSnImportRecipes").html(e);c("#spnERSnImportFiles").html(a.length);g.hide();k.show()}function s(a,b,d){f[b.id]=c.parseJSON(d.response)}function t(){e.hide()}function u(){var h;b&&(g.plupload("destroy"),m.html(""));h=c("#divERSImportFormats").find('input[name="rbERSImportSource"]:checked').val();switch(h){case "paprika":a=[{title:"Paprika (*.paprikarecipe)",extensions:"paprikarecipe"}];
break;case "paprikas":a=[{title:"Paprika (*.paprikarecipes)",extensions:"paprikarecipes"}];break;case "mealmaster":a=[{title:"Meal-Master Format (*.mmf, *.mxp)",extensions:"mmf,mxp"}];break;case "mastercook":a=[{title:"MC 5+ Format (*.mx2)",extensions:"mx2"}];break;case "mastercookmxp":a=[{title:"Older MasterCook Format (*.mxp)",extensions:"mxp"}];break;case "yummysoup":a=[{title:"Yummy Soup Format (*.xml)",extensions:"xml"}];break;case "macgourmet":a=[{title:"MacGourmet Format (*.mgourmet3)",extensions:"mgourmet3"}];
break;case "cookn":a=[{title:"Cook'n HTML (*.html)",extensions:"html"}];break;case "cookbookwiz":a=[{title:"Cookbook Wizard text (*.txt)",extensions:"txt"}];break;default:a=[]}g=c("#divERSImportUploader").plupload({runtimes:"html5,flash,silverlight,html4",url:ajaxurl,multipart_params:{action:"easyrecipeImport",source:h},filters:a,max_file_size:"10mb",chunk_size:"1mb",unique_names:!0,flash_swf_url:l.wpurl+"/wp-includes/js/plupload/plupload.flash.swf",silverlight_xap_url:l.wpurl+"/wp-includes/js/plupload/plupload.silverlight.xap"});
b=g.plupload("getUploader");b.bind("UploadComplete",r);b.bind("FileUploaded",s);b.bind("BeforeUpload",t)}function n(){c("#divERSImportConfirm").hide();g.plupload("destroy");m.html("");p.attr("checked",!1);b=null}function v(a){"OK"===a.status&&window.location.replace(l.editURL)}function w(){}function x(a){var b,d=[];switch(a.target.id){case "btnERSImportCreate":n();e.hide();k.hide();q.show();for(b in f)f.hasOwnProperty(b)&&d.push(f[b].file);c.ajax(ajaxurl,{dataType:"json",data:{action:"easyrecipeCreate",
files:d},type:"POST",success:v,error:w});break;case "btnERSImportCancel":n(),e.show(),k.hide()}}var b=null,g,p,a,m,k,e,q,l,f={};c(function(){var a;l=EASYRECIPE;a=c("#divERSImportButtons").on("click",x);c('input[type="button"]',a).button();p=c("#divERSImportFormats").find('input[name="rbERSImportSource"]').on("change",u);m=c("#divERSImportUploader");k=c("#divERSImportConfirm").hide();e=c("#divERSImportSettings");q=c("#divERSImportCreating").hide()})})(jQuery);
