/*
 EasyRecipe PLUS 3.2.2708 Copyright (c) 2014 BoxHill LLC
*/
window.EASYRECIPE=window.EASYRECIPE||{};
(function(a){function O(l){return a.trim(l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/ /g,"%20"))}function P(a){return a.replace(/%20/g," ").replace(/&quot;/g,'"').replace(/&gt/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/%22/g,'"').replace(/%3C/ig,"<").replace(/%3E/ig,">")}function da(a){var g,c,b;switch(a.target.id){case "btnERGPLCancel":n.dialog(Q);break;case "btnERGPLAdd":a=O(s.val()),g=O(t.val()),""!==g&&(g=' title="'+g+'"'),
c=u.is(":checked")?' target="_blank"':"",b=A||q.selection.getContent(),a='<a href="'+a+'"'+g+c+">"+b+"</a>",e.isEntryDialog?e.insertLink(a):q.selection.setContent(a),n.dialog(Q)}}function R(){var a=q.selection.getNode();"A"===a.tagName.toUpperCase()?(s.val(P(a.href)),t.val(P(a.title)),u.attr("checked","_blank"===a.target),q.selection.select(a),A=a.innerHTML):(s.val("http://"),t.val(""),u.attr("checked",!0),A=!1);n.dialog(S,T,v).dialog(U)}function ea(){var l,g,z,h,f,d=q.selection.getNode();l=a(".ERGPAlignment input:radio[name=rbERGPAlign]:checked").val();
g=a(".ERGPSize input:radio[name=rbERGPSize]:checked").val();"full"===g?(z=c.meta.width,h=c.meta.height,f=c.meta.file):(z=c.meta.sizes[g].width,h=c.meta.sizes[g].height,f=c.meta.sizes[g].file);b="aligncenter"===l?'<p style="text-align:center">':"";b+='<img class="'+l+" size-"+g+" wp-image-"+c.id+'"';b+=' title="'+B.val()+'"';b+=' alt="'+C.val()+'"';b+=' width="'+z+'"';b+=' height="'+h+'"';b+=' src="'+c.baseurl+f+'"';b+=" />";b+="aligncenter"===l?"</p>":"";if(e.isEntryDialog)e.insertUploadedImage(null,
b);else if("#document"===d.nodeName&&(d=a("body",p)[0]),"BODY"===d.nodeName.toUpperCase())a(d).hasClass("mceContentBody")||(d=a("body",p)[0]),a(d).append("&nbsp;"+b);else{for(;d.parentNode&&"BODY"!==d.parentNode.nodeName.toUpperCase();)d=d.parentNode;d.parentNode?"DIV"===d.nodeName.toUpperCase()||"SPAN"===d.nodeName.toUpperCase()?a(d,p).after(b):a(d,p).before(b):(d=a("body",p)[0],a(d).append(b))}r.dialog("close")}function fa(c,g,b){D=!1;typeof tinyMCE!==ga&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()&&
(D=!0);D?(q=tinyMCE.activeEditor,g.editorId===E?(p=a("#"+E+"_ifr").contents(),v=1E4):(p=a("#mce_fullscreen_ifr").contents(),v=200001)):alert("You must use the Visual Editor to add or update an EasyRecipe")}function V(){var b="html5,flash,silverlight,html4";F.hide();G.hide();w.show();H.show();I.text("");B.val("");C.val("");W.val("");r.dialog(S,T,v);r.dialog(U);x.hide();a("#ERGPplupload").html("");plupload.VERSION&&plupload.ua&&"1.5.4"==plupload.VERSION&&plupload.ua.gecko&&(b="flash,silverlight,html4");
k=new plupload.Uploader({runtimes:b,browse_button:"btnERGPSelect",max_file_size:"10mb",container:"easyrecipeUpload",url:ajaxurl,flash_swf_url:e.wpurl+"/wp-includes/js/plupload/plupload.flash.swf",silverlight_xap_url:e.wpurl+"/wp-includes/js/plupload/plupload.silverlight.xap",multipart_params:{postID:X,action:"easyrecipeUpload"},filters:[{title:"Image files",extensions:"jpg,gif,png"}]});k.init();k.bind("FilesAdded",function(a,c){I.text("File: "+c[0].name);J.text(0);y.show();w.hide();F.show();k.start()});
k.bind("UploadProgress",function(a,c){J.text(c.percent);y.progressbar("value",c.percent);100===c.percent&&x.show()});k.bind("Error",function(a,c){a.refresh()});k.bind("FileUploaded",function(b,l,h){var f;c=a.parseJSON(h.response);H.hide();G.show();c.meta.sizes.thumbnail?(b=c.meta.sizes.thumbnail.file,l=c.meta.sizes.thumbnail.width,h=c.meta.sizes.thumbnail.height):(b=c.meta.file,h=c.meta.height,l=c.meta.width);K.attr("src",c.baseurl+b);K.css("top",Math.floor((140-130*h/l)/2));c.postID&&a('.ERGuestPost form input[name="postID"]').val(c.postID);
for(f in m)m.hasOwnProperty(f)&&(b=m[f],c.meta.sizes[f]?(b.attr(L,!1),b.next("span").text(" ("+c.meta.sizes[f].width+" x "+c.meta.sizes[f].height+")")):(b.attr(L,!0),b.next("span").text("")));m.medium.attr(L)?M.attr(Y,!0):m.medium.attr(Y,!0);Z.text(" ("+c.meta.width+" x "+c.meta.height+")");f=c.meta;a("#divERGPFIName").text(f.file);a("#divERGPFIDim").text(f.width+" x "+f.height);a("#divERGPFISize").text(f.filesize);x.hide()});k.refresh()}function ha(){var b,c,e,h=!1;b=a("#spnERGPNameErr");c=a("#spnERGPURLErr");
e=a("#spnERGPEmailErr");b.text("");c.text("");c.text("");""===a.trim($.val())&&(b.text("You must enter your name"),h=!0);""===a.trim(N.val())?(e.text("You must enter your email"),h=!0):ia.test(a.trim(N.val()))||(e.text("You must enter a valid email address"),h=!0);""===a.trim(aa.val())&&(c.text("You must enter your website URL"),h=!0);h||(ba.hide(),ca.show())}var r,S="option",T="zIndex",Q="close",ga="undefined",U="open",w,y,p,E,b,v,q,D,X,k=null,G,H,F,I,c,B,C,W,m={},M,Z,n,L="disabled",Y="checked",
ba,ca,$,N,aa,s,t,u,A,e,J,K,x,ia=/[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?/i;a(function(){var b;e=EASYRECIPE;r=a("#easyrecipeUpload");n=a("#easyrecipeLinks");r.dialog({autoOpen:!1,width:500,height:600,title:"Upload an image",modal:!0,dialogClass:"easyrecipeUpload",close:function(){a(".easyrecipeUpload").filter(function(){return""===a(this).text()}).remove();k&&(k.destroy(),k=null)},open:function(){w.show();
y.progressbar("value",0);a(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});r.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');a('input[type="button"]',n).button();a("#divERGPLBtns").on("click","input",da);n.dialog({autoOpen:!1,width:480,title:"Insert/edit link",modal:!0,dialogClass:"easyrecipeLinks",close:function(){a(".easyrecipeLinks").filter(function(){return""===a(this).text()}).remove()},open:function(){a(".ui-widget-overlay").wrap('<div class="easyrecipeUI" />')}});n.parent(".ui-dialog").wrap('<div class="easyrecipeUI" />');
G=a("#divERGPUploaded");H=a("#divERGPUploadContainer");F=a("#divERGPUploading");I=a("#divERGPFile");B=a("#inpERGPTitle");C=a("#inpERGPAltText");W=a("#inpERGPLinkURL");w=a("#btnERGPSelect").button();u=a("#cbERGPLTarget");t=a("#fldERGPLTitle");s=a("#fldERGPLURL");ca=a("#divERGPPost");ba=a("#divERGPData");$=a("#fldERGPName");N=a("#fldERGPEmail");aa=a("#fldERGPURL");m.thumbnail=a('.ERGPSize input[value="thumbnail"]');m.medium=a('.ERGPSize input[value="medium"]');m.large=a('.ERGPSize input[value="large"]');
M=a('.ERGPSize input[value="full"]');Z=M.next("span");a("#btnERGPInsert").button().on("click",ea);y=a("#divERGPProgress").progressbar().hide();a(window).bind("easyrecipeguestimage",V);a(window).bind("guestpostloaded",fa);a(window).bind("guestpostlink",R);a(".wp-media-buttons").hide();X=a("#ERGPpostID").val();E=a(".wp-editor-wrap").attr("id").replace(/^wp-(.*)-wrap$/ig,"$1");a(".ERGuestPost .ERGPButton").button();a("#btnERGPContinue").on("click",ha);K=a("#imgERGPThumb");J=a("#spnERGComplete");x=a("#divERGPSpinner");
e.isGuest=!0;e.doLink=R;e.doUpload=V;if(b=a("#inpERGPAuthor").val())e.author='"'+b+'"'})})(jQuery);
